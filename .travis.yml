language: java
install: true
sudo: false
os: linux
dist: trusty
services:
- docker
jdk:
- openjdk11
- openjdk12
- openjdk13
script:
- "./gradlew build test integrationTest jacocoTestReport"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
jobs:
  include:
  - stage: Publish to Github Packages
    jdk: openjdk11
    script: skip
    deploy:
      provider: script
      script: "./gradlew clean build publish"
      skip_cleanup: true
      on:
        tags: true
  - stage: Publish to Bintray
    jdk: openjdk11
    script: skip
    deploy:
      provider: script
      script: "./gradlew clean build bintrayUpload "
      skip_cleanup: true
      on:
        tags: true
  - stage: Github Release
    jdk: openjdk11
    script: skip
    deploy:
      provider: releases
      api_key:
        secure: hsORGfo5cZd1g8x/iRGB6bCxaPMHY+lH+USH0D362nNHb9LRa1EjaGRTWu3Z+4AdI2btbfTxMouWI6peTyLpvKdAoOope0bs4yxA9tM48OwYDMxTsHCaC2I7wAhrib8fFpq6KbfhjBjXY9WUxkmafqjMqcZIjRyuWMz6xz19BVQRJNhbOo3U2OSmjoGaNUpwq1xX0TRnarKlO43y/YBY1gs6z7Ag3OxQCYX4dpetBK+0u5r+shMdgPgBBsE5yUDM+BQzzcvAaqLW0YQA3uzI6c94szKZgPLQZ3+GkBh9pRT5XJMCZ1K+is0UqRHH/Nv4gYP3FBPvF8Fibbkk+FUCYrYOqg6UnwWASbdne9wctjlWCrfA+yzjJGvdeX/6NQoSD2OzjaWAwMf2Ari1wOSndWbsLhYou2hrKfycwcDIFjIur6TjiaRFwWcuLlurYGhNzIZ4I4nLJ3+JRAjcHUHa8NEmyCEL1RylWA98KH5+qTpE2O4POS5+YbsqqHzFvwzB2IPjmgKkMWSyQb8eFpmfYjzGiDohKCO+lvdegHpl77mjFJKJgU92r/zLznXVeM48kgA0NmBM+1HbndwQLFTkxdtxDef4iK1JhEBY4CQtDheWNMIze9yoaVkcOznR16VN9bwHCrt5Zvi0m1o16J6627ljsZGZI0r1Sj4PWrDlfhE=
      skip_cleanup: true
      on:
        tags: true
env:
  global:
  - secure: u7AUQHh99sMzHdmOQHkjo8/dGkeooo0FB/iP1RoYl/mint4FTq2IuhmqrxTCg+DQOt5znYPIN4n512X/jxximXzI6lNBvkwDV1+U3YOb4G1OkDxpQ0zR6tNILbmEga3jyH2xxaUGYU0UD1LCPeqQFlIQBYJYgK7wR6Aq63n2BBMtSD/myowqSYCoxAHDpFND8+AYU1ZfsVVWmp2ycFWVIYVWkBSMJs06WIi/0NFXqielV9GUHkGgHotvI7/wtrF0VgrcUvido/tKbrkHEznAYzP80BbpESWwGqmqPKosuymoQ6SeeK44Ph0S7b1W75BYQpjKH6dLK5KXIVgf9woPD6Nv8N/mxSEQw3000g7nGJIkj+IL/s7jKvpjC0/EPHLuOU6BTssiRJuYtHoIErhW6lchVXPR28hgi2uGGoAoop4yyiLGiw8CkYNDpHTnbdlrIAv4uNDHnb030uI2kwX50vk7HJLsY7XoaaSJGRPHYxm1KsV0H1JSCNGrguHk7rHqvQY2fiZeLlydgItUPocQhylgdFRImP7UxKgjJpB59ZXX6Aw+sid4ZvdyoU4RfWlKqTXWQkUJJBK9GC8WDvmlpDnJC2d6DhpaP+HmvXm0ZlUzFAtqtdmhre2dhfy2628K0PPB9Iq1JKK+q7NXg6etsUi67kSLR5OF5gdoY453LzM=
